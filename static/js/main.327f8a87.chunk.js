(this.webpackJsonptemplate_react=this.webpackJsonptemplate_react||[]).push([[0],{23:function(t,e,n){},24:function(t,e,n){},26:function(t,e,n){},28:function(t,e,n){"use strict";n.r(e);var r=n(0),a=n.n(r),c=n(13),u=n.n(c),s=(n(23),n(24),n(1)),o=n.n(s),i=n(3),p=n(4),f=n(5),l=n(15),d=n(14),v=n(34),b=n(32),h=function(){function t(){Object(p.a)(this,t)}return Object(f.a)(t,null,[{key:"get",value:function(){var t=Object(i.a)(o.a.mark((function t(e,n){var r,a;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(r=localStorage.getItem(e))){t.next=3;break}return t.abrupt("return",JSON.parse(r));case 3:return console.debug("Cache: ".concat(e)),t.next=6,n();case 6:a=t.sent;try{localStorage.setItem(e,JSON.stringify(a))}catch(c){localStorage.clear()}return t.abrupt("return",a);case 9:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}()}]),t}(),j={headers:{"Content-Type":"application/json",Accept:"application/json"}},x={headers:{Accept:"text/csv"}};function g(t){return O.apply(this,arguments)}function O(){return(O=Object(i.a)(o.a.mark((function t(e){var n,r;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fetch(e,j);case 2:return n=t.sent,t.next=5,n.json();case 5:return r=t.sent,t.abrupt("return",r);case 7:case"end":return t.stop()}}),t)})))).apply(this,arguments)}var y=function(){function t(){Object(p.a)(this,t)}return Object(f.a)(t,null,[{key:"json",value:function(){var t=Object(i.a)(o.a.mark((function t(e){return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",h.get("WWW.json.v3.".concat(e),Object(i.a)(o.a.mark((function t(){return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",g(e));case 1:case"end":return t.stop()}}),t)})))));case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},{key:"tsv",value:function(){var t=Object(i.a)(o.a.mark((function t(e){var n,r,a,c,u;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fetch(e,x);case 2:return n=t.sent,t.next=5,n.text();case 5:return r=t.sent,a=r.split("\n"),c=a[0].split("\t").map((function(t){return t.replace("\r","")})),u=a.slice(1,-1).map((function(t){var e=t.split("\t");return c.reduce((function(t,n,r){return t[n]=e[r],t}),{})})),t.abrupt("return",u);case 10:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()}]),t}(),k=function(){function t(){Object(p.a)(this,t)}return Object(f.a)(t,null,[{key:"get",value:function(){var t=Object(i.a)(o.a.mark((function t(){return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,y.tsv("https://raw.githubusercontent.com/nuuuwan/covid19/data/covid19.lk_vax_centers.latest.tsv");case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}()}]),t}(),m=n(7);function w(t,e){var n=Object(m.a)(t,2),r=n[0],a=n[1],c=0;for(var u in e){var s=(u-1+e.length)%e.length,o=Object(m.a)(e[u],2),i=o[0],p=o[1],f=Object(m.a)(e[s],2),l=f[0],d=f[1];p>r!==d>r&&a<(l-i)*(r-p)/(d-p)+i&&(c+=1)}return c%2===1}function I(t,e){for(var n in e){var r=e[n];for(var a in r){if(w(t,r[a]))return!0}}return!1}var E=function(){function t(){Object(p.a)(this,t)}return Object(f.a)(t,null,[{key:"getGeoForRegion",value:function(){var t=Object(i.a)(o.a.mark((function t(e,n){var r;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r="data/geo/"+"".concat(e,"/").concat(n,".json"),t.next=3,y.json(r);case 3:return t.abrupt("return",t.sent);case 4:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}()},{key:"getRegionTree",value:function(){var t=Object(i.a)(o.a.mark((function t(){return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return"data/geo/region_tree.json",t.next=3,y.json("data/geo/region_tree.json");case 3:return t.abrupt("return",t.sent);case 4:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}()},{key:"isPointInRegion",value:function(){var e=Object(i.a)(o.a.mark((function e(n,r,a){var c;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.getGeoForRegion(r,a);case 2:return c=e.sent,e.abrupt("return",I(n,c));case 4:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"getRegionsForPoint",value:function(){var e=Object(i.a)(o.a.mark((function e(n,r){var a,c,u,s,i,p,f,l,d;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.getRegionTree();case 2:a=e.sent,c=["province","district","dsd","gnd"],u={},e.t0=o.a.keys(c);case 6:if((e.t1=e.t0()).done){e.next=30;break}s=e.t1.value,i=c[s],p=Object.keys(a),f=!1,e.t2=o.a.keys(p);case 12:if((e.t3=e.t2()).done){e.next=26;break}return l=e.t3.value,d=p[l],e.next=17,t.isPointInRegion(n,i,d);case 17:if(!e.sent){e.next=24;break}return u[i]=d,a=a[d],f=!0,r(u),e.abrupt("break",26);case 24:e.next=12;break;case 26:if(f){e.next=28;break}return e.abrupt("return",u);case 28:e.next=6;break;case 30:return e.abrupt("return",u);case 31:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()}]),t}();var _=function(){function t(){Object(p.a)(this,t)}return Object(f.a)(t,null,[{key:"getEntsByType",value:function(){var t=Object(i.a)(o.a.mark((function t(e){var n;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n="data/ents/"+"".concat(e,".tsv"),t.next=3,y.tsv(n);case 3:return t.abrupt("return",t.sent);case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},{key:"getEntIndexByType",value:function(){var e=Object(i.a)(o.a.mark((function e(n){var r;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.getEntsByType(n);case 2:return r=e.sent,e.abrupt("return",r.reduce((function(t,e){return t[e.id]=e,t}),{}));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"getAllEntIndex",value:function(){var e=Object(i.a)(o.a.mark((function e(){var n,r;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=["province","district","dsd","gnd"],e.next=3,Promise.all(n.map(function(){var e=Object(i.a)(o.a.mark((function e(n){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.getEntIndexByType(n);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 3:return r=e.sent,e.abrupt("return",n.reduce((function(t,e,n){return t[e]=r[n],t}),{}));case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()}]),t}(),F=n(30),S=n(31),R=n(33),T=(n(26),n(2));function C(t){var e=Object(F.a)({click:function(){e.locate()},locationfound:function(t){console.log("location found:",t)},moveend:function(e){t.onMoveEnd(e)}});return null}var P=function(t){Object(l.a)(n,t);var e=Object(d.a)(n);function n(){return Object(p.a)(this,n),e.apply(this,arguments)}return Object(f.a)(n,[{key:"render",value:function(){return Object(T.jsxs)(S.a,{center:this.props.center,zoom:16,children:[Object(T.jsx)(R.a,{url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png"}),this.props.children,Object(T.jsx)(C,{onMoveEnd:this.props.onMoveEnd})]})}}]),n}(r.Component),M=[6.9271,79.8612],B={zIndex:1e4,position:"absolute",top:12,left:60,background:"rgba(256, 256, 256, 0.8)",padding:6,borderRadius:6};function A(t){return t.map((function(t){if(!t.lat)return null;var e=[parseFloat(t.lat),parseFloat(t.lng)],n="green";return t.tags&&(n="red"),Object(T.jsx)(v.a,{center:e,radius:500,pathOptions:{color:n},children:Object(T.jsxs)(b.a,{children:[Object(T.jsx)("h3",{children:t.center}),Object(T.jsx)("h3",{children:t.center_si}),Object(T.jsx)("h3",{children:t.center_ta}),Object(T.jsxs)("ul",{children:[Object(T.jsx)("li",{children:t.formatted_address}),Object(T.jsx)("li",{children:t.formatted_address_si}),Object(T.jsx)("li",{children:t.formatted_address_ta})]}),Object(T.jsx)("hr",{}),Object(T.jsxs)("div",{children:[t.police," Police Area,",t.district," District"]}),Object(T.jsx)("div",{children:t.tags})]})})}))}var L=function(t){Object(l.a)(n,t);var e=Object(d.a)(n);function n(t){var r;return Object(p.a)(this,n),(r=e.call(this,t)).state={customerLayers:[],center:M,regions:void 0,entIndex:{}},r}return Object(f.a)(n,[{key:"componentDidMount",value:function(){var t=Object(i.a)(o.a.mark((function t(){var e,n;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,_.getAllEntIndex();case 2:return e=t.sent,t.next=5,k.get();case 5:n=t.sent,this.setState({allEntIndex:e,customerLayers:[n]});case 7:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"render",value:function(){var t=this.state,e=t.customerLayers,n=t.center,r=t.regions,a=t.allEntIndex,c=e.map(A),u=function(){var t=Object(i.a)(o.a.mark((function t(e){var n,r,a;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.target.getCenter(),c=[n.lat,n.lng],r=c.map((function(t){return Math.round(100*parseFloat(t))/100})),a=function(t){this.setState({regions:t})}.bind(this),t.next=5,E.getRegionsForPoint(r,a);case 5:this.setState({center:r});case 6:case"end":return t.stop()}var c}),t,this)})));return function(e){return t.apply(this,arguments)}}().bind(this),s="Searching...";if(r){s=["province","district","dsd","gnd"].map((function(t){var e=r[t];return e?a[t][e].name:""})).join("/")}return Object(T.jsxs)(T.Fragment,{children:[Object(T.jsx)("div",{style:B,children:s}),Object(T.jsx)(P,{center:n,onMoveEnd:u,children:c})]})}}]),n}(r.Component);var J=function(){return Object(T.jsx)(L,{})},z=function(t){t&&t instanceof Function&&n.e(3).then(n.bind(null,35)).then((function(e){var n=e.getCLS,r=e.getFID,a=e.getFCP,c=e.getLCP,u=e.getTTFB;n(t),r(t),a(t),c(t),u(t)}))};u.a.render(Object(T.jsx)(a.a.StrictMode,{children:Object(T.jsx)(J,{})}),document.getElementById("root")),z()}},[[28,1,2]]]);
//# sourceMappingURL=main.327f8a87.chunk.js.map