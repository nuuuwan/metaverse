(this.webpackJsonptemplate_react=this.webpackJsonptemplate_react||[]).push([[0],{36:function(t,e,n){},38:function(t,e,n){},40:function(t,e,n){},49:function(t,e,n){"use strict";n.r(e);var r=n(0),a=n.n(r),c=n(20),s=n.n(c),o=(n(36),n(28)),u=n(4),i=n(1),p=n.n(i),l=n(3),f=n(6),d=n(7),v=n(22),b=n(21),j=n(11),h=n(55),x=n(53),O=function(){function t(){Object(f.a)(this,t)}return Object(d.a)(t,null,[{key:"get",value:function(){var t=Object(l.a)(p.a.mark((function t(e,n){var r,a;return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(r=localStorage.getItem(e))){t.next=3;break}return t.abrupt("return",JSON.parse(r));case 3:return t.next=5,n();case 5:a=t.sent;try{localStorage.setItem(e,JSON.stringify(a))}catch(c){localStorage.clear()}return t.abrupt("return",a);case 8:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}()}]),t}(),g={headers:{"Content-Type":"application/json",Accept:"application/json"}},m={headers:{Accept:"text/csv"}};function y(t){return k.apply(this,arguments)}function k(){return(k=Object(l.a)(p.a.mark((function t(e){var n,r;return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fetch(e,g);case 2:return n=t.sent,t.next=5,n.json();case 5:return r=t.sent,t.abrupt("return",r);case 7:case"end":return t.stop()}}),t)})))).apply(this,arguments)}var w=function(){function t(){Object(f.a)(this,t)}return Object(d.a)(t,null,[{key:"json",value:function(){var t=Object(l.a)(p.a.mark((function t(e){return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",O.get("WWW.json.v3.".concat(e),Object(l.a)(p.a.mark((function t(){return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",y(e));case 1:case"end":return t.stop()}}),t)})))));case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},{key:"tsv",value:function(){var t=Object(l.a)(p.a.mark((function t(e){var n,r,a,c,s;return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fetch(e,m);case 2:return n=t.sent,t.next=5,n.text();case 5:return r=t.sent,a=r.split("\n"),c=a[0].split("\t").map((function(t){return t.replace("\r","")})),s=a.slice(1,-1).map((function(t){var e=t.split("\t");return c.reduce((function(t,n,r){return t[n]=e[r],t}),{})})),t.abrupt("return",s);case 10:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()}]),t}(),E=function(){function t(){Object(f.a)(this,t)}return Object(d.a)(t,null,[{key:"get",value:function(){var t=Object(l.a)(p.a.mark((function t(){return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,w.tsv("https://raw.githubusercontent.com/nuuuwan/covid19/data/covid19.lk_vax_centers.latest.tsv");case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}()}]),t}();function z(t,e){var n=Object(j.a)(t,2),r=n[0],a=n[1],c=0;for(var s in e){var o=(s-1+e.length)%e.length,u=Object(j.a)(e[s],2),i=u[0],p=u[1],l=Object(j.a)(e[o],2),f=l[0],d=l[1];p>r!==d>r&&a<(f-i)*(r-p)/(d-p)+i&&(c+=1)}return c%2===1}function I(t,e){for(var n in e){var r=e[n];for(var a in r){if(z(t,r[a]))return!0}}return!1}var F=function(){function t(){Object(f.a)(this,t)}return Object(d.a)(t,null,[{key:"getGeoForRegion",value:function(){var t=Object(l.a)(p.a.mark((function t(e,n){var r;return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r="data/geo/"+"".concat(e,"/").concat(n,".json"),t.next=3,w.json(r);case 3:return t.abrupt("return",t.sent);case 4:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}()},{key:"getRegionTree",value:function(){var t=Object(l.a)(p.a.mark((function t(){return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return"data/geo/region_tree.json",t.next=3,w.json("data/geo/region_tree.json");case 3:return t.abrupt("return",t.sent);case 4:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}()},{key:"isPointInRegion",value:function(){var e=Object(l.a)(p.a.mark((function e(n,r,a){var c;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.getGeoForRegion(r,a);case 2:return c=e.sent,e.abrupt("return",I(n,c));case 4:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"getRegionsForPoint",value:function(){var e=Object(l.a)(p.a.mark((function e(n,r){var a,c,s,o,u,i,l,f,d;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.getRegionTree();case 2:a=e.sent,c=["province","district","dsd","gnd"],s={},e.t0=p.a.keys(c);case 6:if((e.t1=e.t0()).done){e.next=30;break}o=e.t1.value,u=c[o],i=Object.keys(a),l=!1,e.t2=p.a.keys(i);case 12:if((e.t3=e.t2()).done){e.next=26;break}return f=e.t3.value,d=i[f],e.next=17,t.isPointInRegion(n,u,d);case 17:if(!e.sent){e.next=24;break}return s[u]=d,a=a[d],l=!0,r(n,s),e.abrupt("break",26);case 24:e.next=12;break;case 26:if(l){e.next=28;break}return e.abrupt("break",30);case 28:e.next=6;break;case 30:r(n,s);case 31:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()}]),t}();function S(t){var e=1e6;return t.map((function(t){return Math.round(parseFloat(t)*e)/e}))}var R=function(){function t(){Object(f.a)(this,t)}return Object(d.a)(t,null,[{key:"getEntsByType",value:function(){var t=Object(l.a)(p.a.mark((function t(e){var n;return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n="data/ents/"+"".concat(e,".tsv"),t.next=3,w.tsv(n);case 3:return t.abrupt("return",t.sent);case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},{key:"getEntIndexByType",value:function(){var e=Object(l.a)(p.a.mark((function e(n){var r;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.getEntsByType(n);case 2:return r=e.sent,e.abrupt("return",r.reduce((function(t,e){return t[e.id]=e,t}),{}));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"getAllEntIndex",value:function(){var e=Object(l.a)(p.a.mark((function e(){var n,r;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=["province","district","dsd","gnd"],e.next=3,Promise.all(n.map(function(){var e=Object(l.a)(p.a.mark((function e(n){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.getEntIndexByType(n);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 3:return r=e.sent,e.abrupt("return",n.reduce((function(t,e,n){return t[e]=r[n],t}),{}));case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()}]),t}(),_=n(50),C=n(51),M=n(54),P=n(52),T=(n(38),n(2));function B(t){return Object(_.a)({moveend:function(e){t.onMoveEnd(e)}}),null}var N=function(t){Object(v.a)(n,t);var e=Object(b.a)(n);function n(){return Object(f.a)(this,n),e.apply(this,arguments)}return Object(d.a)(n,[{key:"render",value:function(){return Object(T.jsxs)(C.a,{center:this.props.center,zoom:this.props.zoom,zoomControl:!1,children:[Object(T.jsx)(M.a,{url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png"}),Object(T.jsx)(B,{onMoveEnd:this.props.onMoveEnd}),this.props.children,Object(T.jsx)("div",{className:"div-center-marker"}),Object(T.jsx)(P.a,{zoom:this.props.zoom,position:"bottomright"})]})}}]),n}(r.Component),A={zIndex:1e4,position:"absolute",top:24,left:60,background:"white",borderRadius:6},L={display:"table-row"},J={display:"table-cell",padding:6},U={fontSize:"40%",color:"black"},D={fontSize:"80%",color:"black"};function W(t){return t.map((function(t){if(!t.lat)return null;var e=[parseFloat(t.lat),parseFloat(t.lng)],n="green";return t.tags&&(n="red"),Object(T.jsx)(h.a,{center:e,radius:500,pathOptions:{color:n},children:Object(T.jsxs)(x.a,{children:[Object(T.jsx)("h3",{children:t.center}),Object(T.jsx)("h3",{children:t.center_si}),Object(T.jsx)("h3",{children:t.center_ta}),Object(T.jsxs)("ul",{children:[Object(T.jsx)("li",{children:t.formatted_address}),Object(T.jsx)("li",{children:t.formatted_address_si}),Object(T.jsx)("li",{children:t.formatted_address_ta})]}),Object(T.jsx)("hr",{}),Object(T.jsxs)("div",{children:[t.police," Police Area,",t.district," District"]}),Object(T.jsx)("div",{children:t.tags})]})})}))}var G=function(t){Object(v.a)(n,t);var e=Object(b.a)(n);function n(t){var r;Object(f.a)(this,n);var a=function(t){var e=t.split(","),n=Object(j.a)(e,3),r=n[0],a=n[1],c=n[2];return{lat:parseFloat(r.replace("N","")),lng:parseFloat(a.replace("E","")),zoom:parseInt(c.replace("z",""))}}((r=e.call(this,t)).props.match.params.locationStr),c=a.lat,s=a.lng,o=a.zoom;return r.state={customerLayers:[],center:[c,s],zoom:o,regions:void 0,entIndex:{},allEntIndex:void 0,lkVaxCenters:void 0},r}return Object(d.a)(n,[{key:"componentDidMount",value:function(){var t=Object(l.a)(p.a.mark((function t(){var e,n;return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,R.getAllEntIndex();case 2:return e=t.sent,t.next=5,E.get();case 5:return n=t.sent,t.next=8,F.getRegionsForPoint(this.state.center,this.onRegionsUpdate.bind(this));case 8:this.setState({allEntIndex:e,customerLayers:[n]});case 9:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"onRegionsUpdate",value:function(){var t=Object(l.a)(p.a.mark((function t(e,n){return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this.setState({center:e,regions:n});case 1:case"end":return t.stop()}}),t,this)})));return function(e,n){return t.apply(this,arguments)}}()},{key:"onMoveEnd",value:function(){var t=Object(l.a)(p.a.mark((function t(e){var n,r,a,c,s,o;return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.target.getCenter(),r=e.target.getZoom(),a=S([n.lat,n.lng]),c=Object(j.a)(a,2),s=c[0],o=c[1],this.props.history.push("/".concat(s,"N,").concat(o,"E,").concat(r,"z")),this.setState({zoom:r}),t.next=8,F.getRegionsForPoint(a,this.onRegionsUpdate.bind(this));case 8:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}()},{key:"render",value:function(){var t=this.state,e=t.customerLayers,n=t.center,r=t.zoom,a=t.regions,c=t.allEntIndex;if(!c)return"...";var s=e.map(W),o="...";if(a){var u=1;o=["province","district","dsd","gnd"].map((function(t){var e=a[t];if(e){var n=c[t][e].name,r=Object.assign({},J,{opacity:u});return u*=.8,Object(T.jsxs)("div",{style:r,children:[Object(T.jsx)("div",{style:D,children:n}),Object(T.jsx)("div",{style:U,children:t.toUpperCase()})]},"region-".concat(e))}return"..."}))}return Object(T.jsxs)(T.Fragment,{children:[Object(T.jsx)("div",{style:A,children:Object(T.jsx)("div",{style:L,children:o})}),Object(T.jsx)(N,{center:n,zoom:r,onMoveEnd:this.onMoveEnd.bind(this),children:s})]})}}]),n}(r.Component);n(40);var V=function(){return Object(T.jsx)(o.a,{basename:"/",children:Object(T.jsxs)(u.d,{children:[Object(T.jsx)(u.b,{path:"/:locationStr",component:G}),Object(T.jsx)(u.b,{children:Object(T.jsx)(u.a,{to:"/6.9157N,79.8636E,15z"})})]})})},Z=function(t){t&&t instanceof Function&&n.e(3).then(n.bind(null,56)).then((function(e){var n=e.getCLS,r=e.getFID,a=e.getFCP,c=e.getLCP,s=e.getTTFB;n(t),r(t),a(t),c(t),s(t)}))};s.a.render(Object(T.jsx)(a.a.StrictMode,{children:Object(T.jsx)(V,{})}),document.getElementById("root")),Z()}},[[49,1,2]]]);
//# sourceMappingURL=main.715732a0.chunk.js.map