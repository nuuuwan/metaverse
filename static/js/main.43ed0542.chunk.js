(this.webpackJsonptemplate_react=this.webpackJsonptemplate_react||[]).push([[0],{24:function(e,t,n){},25:function(e,t,n){},27:function(e,t,n){},29:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n.n(r),c=n(15),u=n.n(c),s=(n(24),n(25),n(1)),o=n.n(s),i=n(3),p=n(4),l=n(5),f=n(13),d=n(12),v=n(35),b=n(33),j=function(){function e(){Object(p.a)(this,e)}return Object(l.a)(e,null,[{key:"get",value:function(){var e=Object(i.a)(o.a.mark((function e(t,n){var r,a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(r=localStorage.getItem(t))){e.next=3;break}return e.abrupt("return",JSON.parse(r));case 3:return console.debug("Cache: ".concat(t)),e.next=6,n();case 6:a=e.sent;try{localStorage.setItem(t,JSON.stringify(a))}catch(c){localStorage.clear()}return e.abrupt("return",a);case 9:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()}]),e}(),h={headers:{"Content-Type":"application/json",Accept:"application/json"}},x={headers:{Accept:"text/csv"}};function g(e){return O.apply(this,arguments)}function O(){return(O=Object(i.a)(o.a.mark((function e(t){var n,r;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(t,h);case 2:return n=e.sent,e.next=5,n.json();case 5:return r=e.sent,e.abrupt("return",r);case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var y=function(){function e(){Object(p.a)(this,e)}return Object(l.a)(e,null,[{key:"json",value:function(){var e=Object(i.a)(o.a.mark((function e(t){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",j.get("WWW.json.v3.".concat(t),Object(i.a)(o.a.mark((function e(){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",g(t));case 1:case"end":return e.stop()}}),e)})))));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"tsv",value:function(){var e=Object(i.a)(o.a.mark((function e(t){var n,r,a,c,u;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(t,x);case 2:return n=e.sent,e.next=5,n.text();case 5:return r=e.sent,a=r.split("\n"),c=a[0].split("\t").map((function(e){return e.replace("\r","")})),u=a.slice(1,-1).map((function(e){var t=e.split("\t");return c.reduce((function(e,n,r){return e[n]=t[r],e}),{})})),e.abrupt("return",u);case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}]),e}(),k=function(){function e(){Object(p.a)(this,e)}return Object(l.a)(e,null,[{key:"get",value:function(){var e=Object(i.a)(o.a.mark((function e(){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,y.tsv("https://raw.githubusercontent.com/nuuuwan/covid19/data/covid19.lk_vax_centers.latest.tsv");case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()}]),e}(),m=n(8);function w(e,t){var n=Object(m.a)(e,2),r=n[0],a=n[1],c=0;for(var u in t){var s=(u-1+t.length)%t.length,o=Object(m.a)(t[u],2),i=o[0],p=o[1],l=Object(m.a)(t[s],2),f=l[0],d=l[1];p>r!==d>r&&a<(f-i)*(r-p)/(d-p)+i&&(c+=1)}return c%2===1}function I(e,t){for(var n in t){var r=t[n];for(var a in r){if(w(e,r[a]))return!0}}return!1}var E=function(){function e(){Object(p.a)(this,e)}return Object(l.a)(e,null,[{key:"getGeoForRegion",value:function(){var e=Object(i.a)(o.a.mark((function e(t,n){var r;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r="data/geo/"+"".concat(t,"/").concat(n,".json"),e.next=3,y.json(r);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"getRegionTree",value:function(){var e=Object(i.a)(o.a.mark((function e(){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"data/geo/region_tree.json",e.next=3,y.json("data/geo/region_tree.json");case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"isPointInRegion",value:function(){var t=Object(i.a)(o.a.mark((function t(n,r,a){var c;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.getGeoForRegion(r,a);case 2:return c=t.sent,t.abrupt("return",I(n,c));case 4:case"end":return t.stop()}}),t)})));return function(e,n,r){return t.apply(this,arguments)}}()},{key:"getRegionsForPoint",value:function(){var t=Object(i.a)(o.a.mark((function t(n,r){var a,c,u,s,i,p,l,f,d;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.getRegionTree();case 2:a=t.sent,c=["province","district","dsd","gnd"],u={},t.t0=o.a.keys(c);case 6:if((t.t1=t.t0()).done){t.next=30;break}s=t.t1.value,i=c[s],p=Object.keys(a),l=!1,t.t2=o.a.keys(p);case 12:if((t.t3=t.t2()).done){t.next=26;break}return f=t.t3.value,d=p[f],t.next=17,e.isPointInRegion(n,i,d);case 17:if(!t.sent){t.next=24;break}return u[i]=d,a=a[d],l=!0,r(n,u),t.abrupt("break",26);case 24:t.next=12;break;case 26:if(l){t.next=28;break}return t.abrupt("break",30);case 28:t.next=6;break;case 30:r(n,u);case 31:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}()}]),e}();function F(e){var t=1e6;return e.map((function(e){return Math.round(parseFloat(e)*t)/t}))}var _=function(){function e(){Object(p.a)(this,e)}return Object(l.a)(e,null,[{key:"getEntsByType",value:function(){var e=Object(i.a)(o.a.mark((function e(t){var n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n="data/ents/"+"".concat(t,".tsv"),e.next=3,y.tsv(n);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"getEntIndexByType",value:function(){var t=Object(i.a)(o.a.mark((function t(n){var r;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.getEntsByType(n);case 2:return r=t.sent,t.abrupt("return",r.reduce((function(e,t){return e[t.id]=t,e}),{}));case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},{key:"getAllEntIndex",value:function(){var t=Object(i.a)(o.a.mark((function t(){var n,r;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=["province","district","dsd","gnd"],t.next=3,Promise.all(n.map(function(){var t=Object(i.a)(o.a.mark((function t(n){return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.getEntIndexByType(n);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()));case 3:return r=t.sent,t.abrupt("return",n.reduce((function(e,t,n){return e[t]=r[n],e}),{}));case 5:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}()}]),e}(),S=n(30),C=n(31),T=n(34),R=(n(27),n(2));function D(e){var t=Object(S.a)({click:function(){t.locate()},locationfound:function(e){console.log("location found:",e)},moveend:function(t){e.onMoveEnd(t)}});return null}var M=function(e){Object(f.a)(n,e);var t=Object(d.a)(n);function n(){return Object(p.a)(this,n),t.apply(this,arguments)}return Object(l.a)(n,[{key:"render",value:function(){return Object(R.jsxs)(C.a,{center:this.props.center,zoom:16,children:[Object(R.jsx)(T.a,{url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png"}),Object(R.jsx)(D,{onMoveEnd:this.props.onMoveEnd}),this.props.children,Object(R.jsx)("div",{className:"div-center-marker"})]})}}]),n}(r.Component),P=n(32),B={fillColor:"#f00",fillOpacity:.1,color:"#f00"},z=function(e){Object(f.a)(n,e);var t=Object(d.a)(n);function n(e){var r;return Object(p.a)(this,n),(r=t.call(this,e)).state={geoData:void 0},r}return Object(l.a)(n,[{key:"componentDidMount",value:function(){var e=Object(i.a)(o.a.mark((function e(){var t,n,r,a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.props,n=t.regionType,r=t.regionID,e.next=3,E.getGeoForRegion(n,r);case 3:a=e.sent,this.setState({geoData:a});case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this.state.geoData;if(!e)return"...";var t={type:"MultiPolygon",coordinates:e};return console.debug(t),Object(R.jsx)(P.a,{data:t,style:B})}}]),n}(r.Component),A=[6.9271,79.8612],L={zIndex:1e4,position:"absolute",top:24,left:60,background:"white",borderRadius:12},J={display:"table-row"},G={display:"table-cell",padding:6},N={fontSize:"40%",color:"#ccc"},W={fontSize:"80%",color:"#888"};function U(e){return e.map((function(e){if(!e.lat)return null;var t=[parseFloat(e.lat),parseFloat(e.lng)],n="green";return e.tags&&(n="red"),Object(R.jsx)(v.a,{center:t,radius:500,pathOptions:{color:n},children:Object(R.jsxs)(b.a,{children:[Object(R.jsx)("h3",{children:e.center}),Object(R.jsx)("h3",{children:e.center_si}),Object(R.jsx)("h3",{children:e.center_ta}),Object(R.jsxs)("ul",{children:[Object(R.jsx)("li",{children:e.formatted_address}),Object(R.jsx)("li",{children:e.formatted_address_si}),Object(R.jsx)("li",{children:e.formatted_address_ta})]}),Object(R.jsx)("hr",{}),Object(R.jsxs)("div",{children:[e.police," Police Area,",e.district," District"]}),Object(R.jsx)("div",{children:e.tags})]})})}))}var q=function(e){Object(f.a)(n,e);var t=Object(d.a)(n);function n(e){var r;return Object(p.a)(this,n),(r=t.call(this,e)).state={customerLayers:[],center:A,regions:void 0,entIndex:{}},r}return Object(l.a)(n,[{key:"componentDidMount",value:function(){var e=Object(i.a)(o.a.mark((function e(){var t,n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,_.getAllEntIndex();case 2:return t=e.sent,e.next=5,k.get();case 5:n=e.sent,this.setState({allEntIndex:t,customerLayers:[n]});case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e,t=this.state,n=t.customerLayers,r=t.center,a=t.regions,c=t.allEntIndex,u=n.map(U),s=function(){var e=Object(i.a)(o.a.mark((function e(t){var n,r,a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.target.getCenter(),r=F([n.lat,n.lng]),a=function(e,t){this.setState({center:e,regions:t})}.bind(this),e.next=5,E.getRegionsForPoint(r,a);case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}().bind(this),p="...";if(a){var l=["gnd","dsd","district","province"],f=1;for(var d in p=l.map((function(e){var t=a[e];if(t){var n=c[e][t].name,r=Object.assign({},G,{opacity:f});return f*=.8,Object(R.jsxs)("div",{style:r,children:[Object(R.jsx)("div",{style:W,children:n}),Object(R.jsx)("div",{style:N,children:e.toUpperCase()})]},"region-".concat(t))}return null})),l){var v=l[d],b=a[v];if(b){e=Object(R.jsx)(z,{regionType:v,regionID:b},"region-geo-layer-".concat(b));break}}}return Object(R.jsxs)(R.Fragment,{children:[Object(R.jsx)("div",{style:L,children:Object(R.jsx)("div",{style:J,children:p})}),Object(R.jsxs)(M,{center:r,onMoveEnd:s,children:[u,e]})]})}}]),n}(r.Component);var H=function(){return Object(R.jsx)(q,{})},K=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,36)).then((function(t){var n=t.getCLS,r=t.getFID,a=t.getFCP,c=t.getLCP,u=t.getTTFB;n(e),r(e),a(e),c(e),u(e)}))};u.a.render(Object(R.jsx)(a.a.StrictMode,{children:Object(R.jsx)(H,{})}),document.getElementById("root")),K()}},[[29,1,2]]]);
//# sourceMappingURL=main.43ed0542.chunk.js.map